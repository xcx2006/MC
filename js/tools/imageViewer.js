export default function imageViewer(){let e=false;let t=1;let s=false;let n=false;let a=0;let l=0;let o=0;let r=0;let i=0;const c=document.querySelector(".image-viewer-container");const d=c.querySelector("img");const f=e=>{document.body.style.overflow=e?"hidden":"auto";e?c.classList.add("active"):c.classList.remove("active")};const u=e=>{e.preventDefault();const s=d.getBoundingClientRect();const n=e.clientX-s.left;const a=e.clientY-s.top;const l=n-s.width/2;const o=a-s.height/2;const c=t;t+=e.deltaY*-.001;t=Math.min(Math.max(.8,t),4);if(c<t){r-=l*(t-c);i-=o*(t-c)}else{r=0;i=0}d.style.transform=`translate(${r}px, ${i}px) scale(${t})`};const m=e=>{e.preventDefault();s=true;l=e.clientX;o=e.clientY;d.style.cursor="grabbing"};let v=0;const p=100;const y=e=>{if(s){const s=(new Date).getTime();if(s-v<p){return}v=s;const a=e.clientX-l;const c=e.clientY-o;r+=a;i+=c;l=e.clientX;o=e.clientY;d.style.transform=`translate(${r}px, ${i}px) scale(${t})`;n=true}};const g=e=>{if(s){e.stopPropagation()}s=false;d.style.cursor="grab"};d.addEventListener("wheel",u,{passive:false});d.addEventListener("mousedown",m,{passive:false});d.addEventListener("mousemove",y,{passive:false});d.addEventListener("mouseup",g,{passive:false});d.addEventListener("mouseleave",g,{passive:false});c.addEventListener("click",(s=>{if(!n){e=false;f(e);t=1;r=0;i=0;d.style.transform=`translate(${r}px, ${i}px) scale(${t})`}n=false}));const h=document.querySelectorAll(".markdown-body img, .masonry-item img, #shuoshuo-content img");const w=s=>{if(s.key==="Escape"&&e){e=false;f(e);t=1;r=0;i=0;d.style.transform=`translate(${r}px, ${i}px) scale(${t})`;document.removeEventListener("keydown",w)}};h.forEach(((t,s)=>{t.addEventListener("click",(()=>{a=s;e=true;f(e);d.src=t.src;document.addEventListener("keydown",w)}))}));const L=t=>{if(!e)return;if(t.key==="ArrowUp"||t.key==="ArrowLeft"){a=(a-1+h.length)%h.length}else if(t.key==="ArrowDown"||t.key==="ArrowRight"){a=(a+1)%h.length}else{return}const s=h[a];let n=s.src;if(s.hasAttribute("lazyload")){n=s.getAttribute("data-src");s.src=n;s.removeAttribute("lazyload")}d.src=n};document.addEventListener("keydown",L);if(!h.length&&c){c.parentNode.removeChild(c)}}